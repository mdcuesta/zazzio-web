'use strict';

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol ? "symbol" : typeof obj; };

var querystring = require('querystring');

var initialized = false;
var msgpath = { host: 'rest.nexmo.com', path: '/sms/json' };
var shortcodePath = { host: 'rest.nexmo.com', path: '/sc/us/${type}/json' };
var ttsEndpoint = { host: 'api.nexmo.com', path: '/tts/json' };
var ttsPromptEndpoint = { host: 'api.nexmo.com', path: '/tts-prompt/json' };
var callEndpoint = { host: 'rest.nexmo.com', path: '/call/json' };
var verifyEndpoint = { host: 'api.nexmo.com', path: '/verify/json' };
var checkVerifyEndpoint = { host: 'api.nexmo.com', path: '/verify/check/json' };
var controlVerifyEndpoint = { host: 'api.nexmo.com', path: '/verify/control/json' };
var searchVerifyEndpoint = { host: 'api.nexmo.com', path: '/verify/search/json' };
var niEndpoint = { host: 'rest.nexmo.com', path: '/ni/json' };
var niBasicEndpoint = { host: 'api.nexmo.com', path: '/number/format/json' };
var niStandardEndpoint = { host: 'api.nexmo.com', path: '/number/lookup/json' };
var applicationsEndpoint = { host: 'api.nexmo.com', path: '/v1/applications' };
var up = {};
var numberPattern = new RegExp("^[0-9 +()-]*$");
var _options = null;

//Error message resources are maintained globally in one place for easy management
var ERROR_MESSAGES = {
    sender: 'Invalid from address',
    to: 'Invalid to address',
    msg: 'Invalid Text Message',
    msgParams: 'Invalid shortcode message parameters',
    countrycode: 'Invalid Country Code',
    msisdn: 'Invalid MSISDN passed',
    body: 'Invalid Body value in Binary Message',
    udh: 'Invalid udh value in Binary Message',
    title: 'Invalid title in WAP Push message',
    url: 'Invalid url in WAP Push message',
    maxDigits: 'Invalid max digits for TTS prompt',
    byeText: 'Invalid bye text for TTS prompt',
    pinCode: 'Invalid pin code for TTS confirm',
    failedText: 'Invalid failed text for TTS confirm',
    answerUrl: 'Invalid answer URL for call',
    verifyValidation: 'Missing Mandatory fields (number and/or brand)',
    checkVerifyValidation: 'Missing Mandatory fields (request_id and/or code)',
    controlVerifyValidation: 'Missing Mandatory fields (request_id and/or cmd-command)',
    searchVerifyValidation: 'Missing Mandatory fields (request_id or request_ids)',
    numberInsightAdvancedValidation: 'Missing Mandatory fields (number and/or callback url)',
    numberInsightValidation: 'Missing Mandatory field - number',
    numberInsightPatternFailure: 'Number can contain digits and may include any or all of the following: white space, -,+, (, ).',
    optionsNotAnObject: 'Options parameter should be a dictionary. Check the docs for valid properties for options',
    applicationName: 'Invalid argument: name',
    applicationType: 'Invalid argument: type (valid options: [voice])',
    applicationAnswerUrl: 'Invalid argument: answerUrl',
    applicationEventUrl: 'Invalid argument: eventUrl',
    applicationId: 'Invalid argument: appId',
    product: 'Invalid product. Should be one of [voice, sms]'
};

exports.initialize = function (pkey, psecret, options) {
    if (!pkey || !psecret) {
        throw 'key and secret cannot be empty, set valid values';
    }
    up = {
        api_key: pkey,
        api_secret: psecret
    };
    _options = options;
    initialized = true;
};

exports.sendBinaryMessage = function (sender, recipient, body, udh, callback) {
    if (!body) {
        sendError(callback, new Error(ERROR_MESSAGES.body));
    } else if (!udh) {
        sendError(callback, new Error(ERROR_MESSAGES.udh));
    } else {
        sendMessage({
            from: sender,
            to: recipient,
            type: 'binary',
            body: body,
            udh: udh
        }, callback);
    }
};

exports.sendWapPushMessage = function (sender, recipient, title, url, validity, callback) {
    if (!title) {
        sendError(callback, new Error(ERROR_MESSAGES.title));
    } else if (!url) {
        sendError(callback, new Error(ERROR_MESSAGES.url));
    } else {
        if (typeof validity == 'function') {
            callback = validity;
            validity = 86400000;
        }
        sendMessage({
            from: sender,
            to: recipient,
            type: 'wappush',
            title: title,
            validity: validity,
            url: url
        }, callback);
    }
};

exports.sendTextMessage = function (sender, recipient, message, opts, callback) {
    if (!message) {
        sendError(callback, new Error(ERROR_MESSAGES.msg));
    } else {
        if (!callback) {
            callback = opts;
            opts = {};
        }
        opts['from'] = sender;
        opts['to'] = recipient;
        opts['text'] = message;
        sendMessage(opts, callback);
    }
};

exports.sendMessage = function (opts, callback) {
    sendMessage(opts, callback);
};
function sendMessage(data, callback) {
    if (!data.from) {
        sendError(callback, new Error(ERROR_MESSAGES.sender));
    } else if (!data.to) {
        sendError(callback, new Error(ERROR_MESSAGES.to));
    } else {
        var path = clone(msgpath);
        path.path += '?' + querystring.stringify(data);
        _options.logger.info('sending message from ' + data.from + ' to ' + data.to + ' with message ' + data.text);
        sendRequest(path, 'POST', function (err, apiResponse) {
            if (!err && apiResponse.status && apiResponse.messages[0].status > 0) {
                sendError(callback, new Error(apiResponse.messages[0]['error-text']), apiResponse);
            } else {
                if (callback) callback(err, apiResponse);
            }
        });
    }
}

function sendViaShortcode(type, recipient, messageParams, opts, callback) {
    if (!recipient) {
        sendError(callback, new Error(ERROR_MESSAGES.to));
    }
    if (!messageParams || !Object.keys(messageParams)) {
        sendError(callback, new Error(ERROR_MESSAGES.msgParams));
    }
    opts = opts || {};
    var path = clone(shortcodePath);
    path.path = path.path.replace('${type}', type);
    Object.keys(messageParams).forEach(function (key) {
        opts[key] = messageParams[key];
    });
    opts.to = recipient;
    path.path += '?' + querystring.stringify(opts);
    _options.logger.info('sending message from shortcode ' + type + ' to ' + recipient + ' with parameters ' + JSON.stringify(messageParams));
    sendRequest(path, 'POST', function (err, apiResponse) {
        if (!err && apiResponse.status && apiResponse.messages[0].status > 0) {
            sendError(callback, new Error(apiResponse.messages[0]['error-text']), apiResponse);
        } else {
            if (callback) callback(err, apiResponse);
        }
    });
}
exports.shortcodeAlert = function (recipient, messageParams, opts, callback) {
    sendViaShortcode('alert', recipient, messageParams, opts, callback);
};
exports.shortcode2FA = function (recipient, messageParams, opts, callback) {
    sendViaShortcode('2fa', recipient, messageParams, opts, callback);
};
exports.shortcodeMarketing = function (recipient, messageParams, opts, callback) {
    sendViaShortcode('marketing', recipient, messageParams, opts, callback);
};

function clone(a) {
    return JSON.parse(JSON.stringify(a));
}

function getEndpoint(action) {
    return { path: action };
}

function sendRequest(endpoint, method, callback) {
    endpoint.path = endpoint.path + (endpoint.path.indexOf('?') > 0 ? '&' : '?') + querystring.stringify(up);
    _options.httpClient.request(endpoint, method, callback);
}

exports.checkBalance = function (callback) {
    var balanceEndpoint = getEndpoint('/account/get-balance');
    sendRequest(balanceEndpoint, callback);
};

exports.getPricing = function (countryCode, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else {
        var pricingEndpoint = getEndpoint('/account/get-pricing/outbound');
        pricingEndpoint.path += '?country=' + countryCode;
        sendRequest(pricingEndpoint, callback);
    }
};

exports.getPhonePricing = function (product, msisdn, callback) {
    if (!product || product != 'sms' && product != 'voice') {
        sendError(callback, new Error(ERROR_MESSAGES.product));
    } else if (!msisdn || msisdn.length < 10) {
        // check if MSISDN validation is correct for international numbers
        sendError(callback, new Error(ERROR_MESSAGES.msisdn));
    } else {
        var pricingEndpoint = getEndpoint('/account/get-phone-pricing/outbound');
        pricingEndpoint.path += "/" + product + "/" + up.api_key + "/" + up.api_secret + "/" + msisdn;
        sendRequest(pricingEndpoint, callback);
    }
};

exports.getNumbers = function (options, callback) {
    var numbersEndpoint = getEndpoint('/account/numbers');
    if (typeof options == 'function') {
        callback = options;
    } else if ((typeof options === 'undefined' ? 'undefined' : _typeof(options)) == 'object') {
        numbersEndpoint.path = numbersEndpoint.path + '?';
        for (var key in options) {
            numbersEndpoint.path = numbersEndpoint.path + key + '=' + options[key] + '&';
        }
    } else {
        sendError(callback, new Error(ERROR_MESSAGES.optionsNotAnObject));
        return;
    }
    sendRequest(numbersEndpoint, callback);
};

exports.searchNumbers = function (countryCode, pattern, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else {
        var searchEndpoint = getEndpoint('/number/search');
        searchEndpoint.path += '?country=' + countryCode;
        if (typeof pattern == 'function') {
            callback = pattern;
        } else if ((typeof pattern === 'undefined' ? 'undefined' : _typeof(pattern)) == 'object') {
            searchEndpoint.path = searchEndpoint.path + '&';
            for (var arg in pattern) {
                searchEndpoint.path = searchEndpoint.path + arg + '=' + pattern[arg] + '&';
            }
        } else {
            searchEndpoint.path = searchEndpoint.path + '&pattern=' + pattern;
        }
        sendRequest(searchEndpoint, callback);
    }
};

exports.buyNumber = function (countryCode, msisdn, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else if (!msisdn || msisdn.length < 10) {
        // check if MSISDN validation is correct for international numbers
        sendError(callback, new Error(ERROR_MESSAGES.msisdn));
    } else {
        var buyEndpoint = getEndpoint('/number/buy');
        buyEndpoint.path += '?country=' + countryCode + '&msisdn=' + msisdn;
        sendRequest(buyEndpoint, 'POST', callback);
    }
};

exports.cancelNumber = function (countryCode, msisdn, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else if (!msisdn || msisdn.length < 10) {
        sendError(callback, new Error(ERROR_MESSAGES.msisdn));
    } else {
        var cancelEndpoint = getEndpoint('/number/cancel');
        cancelEndpoint.path += '?country=' + countryCode + '&msisdn=' + msisdn;
        sendRequest(cancelEndpoint, 'POST', callback);
    }
};

exports.cancelNumber = function (countryCode, msisdn, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else if (!msisdn || msisdn.length < 10) {
        sendError(callback, new Error(ERROR_MESSAGES.msisdn));
    } else {
        var cancelEndpoint = getEndpoint('/number/cancel');
        cancelEndpoint.path += '?country=' + countryCode + '&msisdn=' + msisdn;
        sendRequest(cancelEndpoint, 'POST', callback);
    }
};

exports.updateNumber = function (countryCode, msisdn, params, callback) {
    if (!countryCode || countryCode.length != 2) {
        sendError(callback, new Error(ERROR_MESSAGES.countrycode));
    } else if (!msisdn || msisdn.length < 10) {
        sendError(callback, new Error(ERROR_MESSAGES.msisdn));
    } else {
        var updateEndpoint = getEndpoint('/number/update');
        updateEndpoint.path += '?country=' + countryCode + '&msisdn=' + msisdn;
        updateEndpoint.path = updateEndpoint.path + '&';
        for (var arg in params) {
            updateEndpoint.path = updateEndpoint.path + arg + '=' + encodeURIComponent(params[arg]) + '&';
        }
        sendRequest(updateEndpoint, 'POST', callback);
    }
};

exports.getApplications = function (options, callback) {
    var endpoint = getEndpoint(applicationsEndpoint.path);
    endpoint.host = applicationsEndpoint.host;
    if (typeof options == 'function') {
        callback = options;
    } else if ((typeof options === 'undefined' ? 'undefined' : _typeof(options)) == 'object') {
        endpoint.path += '?';
        for (var key in options) {
            endpoint.path += key + '=' + options[key] + '&';
        }
    } else {
        sendError(callback, new Error(ERROR_MESSAGES.optionsNotAnObject));
        return;
    }
    sendRequest(endpoint, callback);
};

exports.createApplication = function (name, type, answerUrl, eventUrl, options, callback) {
    if (!name || name.length < 1) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationName));
    } else if (!type || type != 'voice') {
        sendError(callback, new Error(ERROR_MESSAGES.applicationType));
    } else if (!answerUrl) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationAnswerUrl));
    } else if (!eventUrl) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationEventUrl));
    } else {
        var createEndpoint = getEndpoint(applicationsEndpoint.path);
        createEndpoint.host = applicationsEndpoint.host;
        createEndpoint.path += '?name=' + encodeURIComponent(name) + '&type=' + type + '&answer_url=' + answerUrl + '&event_url=' + eventUrl;
        for (var key in options) {
            createEndpoint.path += '&' + key + '=' + options[key];
        }
        sendRequest(createEndpoint, 'POST', callback);
    }
};

exports.getApplication = function (appId, callback) {
    if (!appId || appId.length < 36) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationId));
    } else {
        var showEndpoint = getEndpoint(applicationsEndpoint.path + "/" + appId);
        showEndpoint.host = applicationsEndpoint.host;
        sendRequest(showEndpoint, callback);
    }
};

exports.updateApplication = function (appId, name, type, answerUrl, eventUrl, options, callback) {
    if (!appId || appId.length < 36) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationId));
    } else if (!name || name.length < 1) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationName));
    } else if (!type || type != 'voice') {
        sendError(callback, new Error(ERROR_MESSAGES.applicationType));
    } else if (!answerUrl) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationAnswerUrl));
    } else if (!eventUrl) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationEventUrl));
    } else {
        var updateEndpoint = getEndpoint(applicationsEndpoint.path + "/" + appId);
        updateEndpoint.path += '?name=' + encodeURIComponent(name) + '&type=' + type + '&answer_url=' + answerUrl + '&event_url=' + eventUrl;
        updateEndpoint.host = applicationsEndpoint.host;
        for (var key in options) {
            updateEndpoint.path = updateEndpoint.path + '&' + key + '=' + options[key];
        }
        sendRequest(updateEndpoint, 'PUT', callback);
    }
};

exports.deleteApplication = function (appId, callback) {
    if (!appId || appId.length < 36) {
        sendError(callback, new Error(ERROR_MESSAGES.applicationId));
    } else {
        var deleteEndpoint = getEndpoint(applicationsEndpoint.path + "/" + appId);
        deleteEndpoint.host = applicationsEndpoint.host;
        sendRequest(deleteEndpoint, 'DELETE', callback);
    }
};

exports.changePassword = function (newSecret, callback) {
    var settingsEndpoint = getEndpoint('/account/settings');
    settingsEndpoint.path += '?newSecret=' + encodeURIComponent(newSecret);
    sendRequest(settingsEndpoint, 'POST', callback);
};

exports.changeMoCallbackUrl = function (newUrl, callback) {
    var settingsEndpoint = getEndpoint('/account/settings');
    settingsEndpoint.path += '?moCallBackUrl=' + encodeURIComponent(newUrl);
    sendRequest(settingsEndpoint, 'POST', callback);
};

exports.changeDrCallbackUrl = function (newUrl, callback) {
    var settingsEndpoint = getEndpoint('/account/settings');
    settingsEndpoint.path += '?drCallBackUrl=' + encodeURIComponent(newUrl);
    sendRequest(settingsEndpoint, 'POST', callback);
};

exports.verifyNumber = function (inputParams, callback) {
    if (!inputParams.number || !inputParams.brand) {
        sendError(callback, new Error(ERROR_MESSAGES.verifyValidation));
    } else {
        var vEndpoint = clone(verifyEndpoint);
        vEndpoint.path += '?' + querystring.stringify(inputParams);
        sendRequest(vEndpoint, callback);
    }
};

exports.checkVerifyRequest = function (inputParams, callback) {
    if (!inputParams.request_id || !inputParams.code) {
        sendError(callback, new Error(ERROR_MESSAGES.checkVerifyValidation));
    } else {
        var vEndpoint = clone(checkVerifyEndpoint);
        vEndpoint.path += '?' + querystring.stringify(inputParams);
        sendRequest(vEndpoint, callback);
    }
};

exports.controlVerifyRequest = function (inputParams, callback) {
    if (!inputParams.request_id || !inputParams.cmd) {
        sendError(callback, new Error(ERROR_MESSAGES.controlVerifyValidation));
    } else {
        var vEndpoint = clone(controlVerifyEndpoint);
        vEndpoint.path += '?' + querystring.stringify(inputParams);
        sendRequest(vEndpoint, callback);
    }
};

exports.searchVerifyRequest = function (requestIds, callback) {
    var requestIdParam = {};
    if (!requestIds) {
        sendError(callback, new Error(ERROR_MESSAGES.searchVerifyValidation));
    } else {
        if (Array.isArray(requestIds)) {
            if (requestIds.length == 1) {
                requestIdParam.request_id = requestIds;
            } else {
                requestIdParam.request_ids = requestIds;
            }
        } else {
            requestIdParam.request_id = requestIds;
        }
        var vEndpoint = clone(searchVerifyEndpoint);
        vEndpoint.path += '?' + querystring.stringify(requestIdParam);
        sendRequest(vEndpoint, callback);
    }
};

exports.numberInsight = function (inputParams, callback) {
    if (!inputParams.number || !inputParams.callback) {
        sendError(callback, new Error(ERROR_MESSAGES.numberInsightAdvancedValidation));
    } else {
        var nEndpoint = clone(niEndpoint);
        nEndpoint.path += '?' + querystring.stringify(inputParams);
        sendRequest(nEndpoint, callback);
    }
};

exports.numberInsightBasic = function (inputParams, callback) {
    numberInsightCommon(niBasicEndpoint, inputParams, callback);
};

exports.numberInsightStandard = function (inputParams, callback) {
    numberInsightCommon(niStandardEndpoint, inputParams, callback);
};

function numberInsightCommon(endpoint, inputParams, callback) {
    if (validateNumber(inputParams, callback)) {
        var inputObj;
        if ((typeof inputParams === 'undefined' ? 'undefined' : _typeof(inputParams)) != 'object') {
            inputObj = { number: inputParams };
        } else {
            inputObj = inputParams;
        }
        var nEndpoint = clone(endpoint);
        nEndpoint.path += '?' + querystring.stringify(inputObj);
        sendRequest(nEndpoint, callback);
    }
}
function validateNumber(inputParams, callback) {
    if ((typeof inputParams === 'undefined' ? 'undefined' : _typeof(inputParams)) == 'object' && !inputParams.number) {
        sendError(callback, new Error(ERROR_MESSAGES.numberInsightValidation));
        return false;
    } else if ((typeof inputParams === 'undefined' ? 'undefined' : _typeof(inputParams)) == 'object' && !numberPattern.test(inputParams.number)) {
        sendError(callback, new Error(ERROR_MESSAGES.numberInsightPatternFailure));
        return false;
    } else if ((typeof inputParams === 'undefined' ? 'undefined' : _typeof(inputParams)) != 'object' && (!inputParams || !numberPattern.test(inputParams))) {
        sendError(callback, new Error(ERROR_MESSAGES.numberInsightPatternFailure));
        return false;
    }
    return true;
}

function sendVoiceMessage(voiceEndpoint, data, callback) {
    if (!data.to) {
        sendError(callback, new Error(ERROR_MESSAGES.to));
    } else {
        var endpoint = clone(voiceEndpoint);
        endpoint.path += '?' + querystring.stringify(data);
        _options.logger.info('sending TTS message to ' + data.to + ' with message ' + data.text);
        sendRequest(endpoint, 'POST', function (err, apiResponse) {
            if (!err && apiResponse.status && apiResponse.status > 0) {
                sendError(callback, new Error(apiResponse['error-text']), apiResponse);
            } else {
                if (callback) callback(err, apiResponse);
            }
        });
    }
}

exports.sendTTSMessage = function (recipient, message, opts, callback) {
    if (!message) {
        sendError(callback, new Error(ERROR_MESSAGES.msg));
    } else {
        if (!opts) {
            opts = {};
        }
        opts['to'] = recipient;
        opts['text'] = message;
        sendVoiceMessage(ttsEndpoint, opts, callback);
    }
};

exports.sendTTSPromptWithCapture = function (recipient, message, maxDigits, byeText, opts, callback) {
    if (!message) {
        sendError(callback, new Error(ERROR_MESSAGES.msg));
    } else if (!maxDigits || isNaN(maxDigits) || maxDigits.length > 16) {
        sendError(callback, new Error(ERROR_MESSAGES.maxDigits));
    } else if (!byeText) {
        sendError(callback, new Error(ERROR_MESSAGES.byeText));
    } else {
        if (!opts) {
            opts = {};
        }
        opts['to'] = recipient;
        opts['text'] = message;
        opts['max_digits'] = maxDigits;
        opts['bye_text'] = byeText;
        sendVoiceMessage(ttsPromptEndpoint, opts, callback);
    }
};

exports.sendTTSPromptWithConfirm = function (recipient, message, maxDigits, pinCode, byeText, failedText, opts, callback) {
    if (!message) {
        sendError(callback, new Error(ERROR_MESSAGES.msg));
    } else if (!maxDigits || isNaN(maxDigits) || maxDigits.length > 16) {
        sendError(callback, new Error(ERROR_MESSAGES.maxDigits));
    } else if (!pinCode || pinCode.length !== maxDigits) {
        sendError(callback, new Error(ERROR_MESSAGES.pinCode));
    } else if (!byeText) {
        sendError(callback, new Error(ERROR_MESSAGES.byeText));
    } else if (!failedText) {
        sendError(callback, new Error(ERROR_MESSAGES.failedText));
    } else {
        if (!opts) {
            opts = {};
        }
        opts['to'] = recipient;
        opts['text'] = message;
        opts['max_digits'] = maxDigits;
        opts['pin_code'] = pinCode;
        opts['bye_text'] = byeText;
        opts['failed_text'] = failedText;
        sendVoiceMessage(ttsPromptEndpoint, opts, callback);
    }
};

exports.call = function (recipient, answerUrl, opts, callback) {
    if (!answerUrl) {
        sendError(callback, new Error(ERROR_MESSAGES.answerUrl));
    } else {
        if (!opts) {
            opts = {};
        }
        opts['to'] = recipient;
        opts['answer_url'] = answerUrl;
        sendVoiceMessage(callEndpoint, opts, callback);
    }
};

function sendError(callback, err, returnData) {
    // Throw the error in case if there is no callback passed
    if (callback) {
        callback(err, returnData);
    } else {
        throw err;
    }
}

exports.setHost = function (aHost) {
    msgpath.host = aHost;
    shortcodePath.host = aHost;
    ttsEndpoint.host = aHost;
    ttsPromptEndpoint.host = aHost;
    callEndpoint.host = aHost;
    verifyEndpoint.host = aHost;
    checkVerifyEndpoint.host = aHost;
    controlVerifyEndpoint.host = aHost;
    searchVerifyEndpoint.host = aHost;
    niEndpoint.host = aHost;
    niBasicEndpoint.host = aHost;
    niStandardEndpoint.host = aHost;
    applicationsEndpoint.host = aHost;
};

exports.setPort = function (aPort) {
    port = aPort;
};
//# sourceMappingURL=data:application/json;base64,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dmFyIHF1ZXJ5c3RyaW5nID0gcmVxdWlyZSgncXVlcnlzdHJpbmcnKTtcblxudmFyIGluaXRpYWxpemVkID0gZmFsc2U7XG52YXIgbXNncGF0aCA9IHtob3N0OidyZXN0Lm5leG1vLmNvbScscGF0aDonL3Ntcy9qc29uJ307XG52YXIgc2hvcnRjb2RlUGF0aCA9IHtob3N0OidyZXN0Lm5leG1vLmNvbScscGF0aDonL3NjL3VzLyR7dHlwZX0vanNvbid9O1xudmFyIHR0c0VuZHBvaW50ID0ge2hvc3Q6J2FwaS5uZXhtby5jb20nLHBhdGg6Jy90dHMvanNvbid9O1xudmFyIHR0c1Byb21wdEVuZHBvaW50ID0ge2hvc3Q6J2FwaS5uZXhtby5jb20nLHBhdGg6Jy90dHMtcHJvbXB0L2pzb24nfTtcbnZhciBjYWxsRW5kcG9pbnQgPSB7aG9zdDoncmVzdC5uZXhtby5jb20nLHBhdGg6Jy9jYWxsL2pzb24nfTtcbnZhciB2ZXJpZnlFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvdmVyaWZ5L2pzb24nfTtcbnZhciBjaGVja1ZlcmlmeUVuZHBvaW50ID0ge2hvc3Q6J2FwaS5uZXhtby5jb20nLHBhdGg6Jy92ZXJpZnkvY2hlY2svanNvbid9O1xudmFyIGNvbnRyb2xWZXJpZnlFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvdmVyaWZ5L2NvbnRyb2wvanNvbid9O1xudmFyIHNlYXJjaFZlcmlmeUVuZHBvaW50ID0ge2hvc3Q6J2FwaS5uZXhtby5jb20nLHBhdGg6Jy92ZXJpZnkvc2VhcmNoL2pzb24nfTtcbnZhciBuaUVuZHBvaW50ID0ge2hvc3Q6J3Jlc3QubmV4bW8uY29tJyxwYXRoOicvbmkvanNvbid9O1xudmFyIG5pQmFzaWNFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvbnVtYmVyL2Zvcm1hdC9qc29uJ307XG52YXIgbmlTdGFuZGFyZEVuZHBvaW50ID0ge2hvc3Q6J2FwaS5uZXhtby5jb20nLHBhdGg6Jy9udW1iZXIvbG9va3VwL2pzb24nfTtcbnZhciBhcHBsaWNhdGlvbnNFbmRwb2ludCA9IHtob3N0OidhcGkubmV4bW8uY29tJyxwYXRoOicvdjEvYXBwbGljYXRpb25zJ307XG52YXIgdXAgPSB7fTtcbnZhciBudW1iZXJQYXR0ZXJuID0gbmV3IFJlZ0V4cChcIl5bMC05ICsoKS1dKiRcIik7XG52YXIgX29wdGlvbnMgPSBudWxsO1xuXG4vL0Vycm9yIG1lc3NhZ2UgcmVzb3VyY2VzIGFyZSBtYWludGFpbmVkIGdsb2JhbGx5IGluIG9uZSBwbGFjZSBmb3IgZWFzeSBtYW5hZ2VtZW50XG52YXIgRVJST1JfTUVTU0FHRVMgPSB7XG4gICAgc2VuZGVyOiAnSW52YWxpZCBmcm9tIGFkZHJlc3MnLFxuICAgIHRvOiAnSW52YWxpZCB0byBhZGRyZXNzJyxcbiAgICBtc2c6ICdJbnZhbGlkIFRleHQgTWVzc2FnZScsXG4gICAgbXNnUGFyYW1zOiAnSW52YWxpZCBzaG9ydGNvZGUgbWVzc2FnZSBwYXJhbWV0ZXJzJyxcbiAgICBjb3VudHJ5Y29kZTogJ0ludmFsaWQgQ291bnRyeSBDb2RlJyxcbiAgICBtc2lzZG46ICdJbnZhbGlkIE1TSVNETiBwYXNzZWQnLFxuICAgIGJvZHk6ICdJbnZhbGlkIEJvZHkgdmFsdWUgaW4gQmluYXJ5IE1lc3NhZ2UnLFxuICAgIHVkaDogJ0ludmFsaWQgdWRoIHZhbHVlIGluIEJpbmFyeSBNZXNzYWdlJyxcbiAgICB0aXRsZTogJ0ludmFsaWQgdGl0bGUgaW4gV0FQIFB1c2ggbWVzc2FnZScsXG4gICAgdXJsOiAnSW52YWxpZCB1cmwgaW4gV0FQIFB1c2ggbWVzc2FnZScsXG4gICAgbWF4RGlnaXRzOiAnSW52YWxpZCBtYXggZGlnaXRzIGZvciBUVFMgcHJvbXB0JyxcbiAgICBieWVUZXh0OiAnSW52YWxpZCBieWUgdGV4dCBmb3IgVFRTIHByb21wdCcsXG4gICAgcGluQ29kZTogJ0ludmFsaWQgcGluIGNvZGUgZm9yIFRUUyBjb25maXJtJyxcbiAgICBmYWlsZWRUZXh0OiAnSW52YWxpZCBmYWlsZWQgdGV4dCBmb3IgVFRTIGNvbmZpcm0nLFxuICAgIGFuc3dlclVybDogJ0ludmFsaWQgYW5zd2VyIFVSTCBmb3IgY2FsbCcsXG5cdHZlcmlmeVZhbGlkYXRpb246J01pc3NpbmcgTWFuZGF0b3J5IGZpZWxkcyAobnVtYmVyIGFuZC9vciBicmFuZCknLFxuXHRjaGVja1ZlcmlmeVZhbGlkYXRpb246J01pc3NpbmcgTWFuZGF0b3J5IGZpZWxkcyAocmVxdWVzdF9pZCBhbmQvb3IgY29kZSknLFxuXHRjb250cm9sVmVyaWZ5VmFsaWRhdGlvbjonTWlzc2luZyBNYW5kYXRvcnkgZmllbGRzIChyZXF1ZXN0X2lkIGFuZC9vciBjbWQtY29tbWFuZCknLFxuXHRzZWFyY2hWZXJpZnlWYWxpZGF0aW9uOidNaXNzaW5nIE1hbmRhdG9yeSBmaWVsZHMgKHJlcXVlc3RfaWQgb3IgcmVxdWVzdF9pZHMpJyxcblx0bnVtYmVySW5zaWdodEFkdmFuY2VkVmFsaWRhdGlvbjonTWlzc2luZyBNYW5kYXRvcnkgZmllbGRzIChudW1iZXIgYW5kL29yIGNhbGxiYWNrIHVybCknLFxuXHRudW1iZXJJbnNpZ2h0VmFsaWRhdGlvbjonTWlzc2luZyBNYW5kYXRvcnkgZmllbGQgLSBudW1iZXInLFxuXHRudW1iZXJJbnNpZ2h0UGF0dGVybkZhaWx1cmU6J051bWJlciBjYW4gY29udGFpbiBkaWdpdHMgYW5kIG1heSBpbmNsdWRlIGFueSBvciBhbGwgb2YgdGhlIGZvbGxvd2luZzogd2hpdGUgc3BhY2UsIC0sKywgKCwgKS4nLFxuXHRvcHRpb25zTm90QW5PYmplY3Q6J09wdGlvbnMgcGFyYW1ldGVyIHNob3VsZCBiZSBhIGRpY3Rpb25hcnkuIENoZWNrIHRoZSBkb2NzIGZvciB2YWxpZCBwcm9wZXJ0aWVzIGZvciBvcHRpb25zJyxcbiAgICBhcHBsaWNhdGlvbk5hbWU6ICdJbnZhbGlkIGFyZ3VtZW50OiBuYW1lJyxcbiAgICBhcHBsaWNhdGlvblR5cGU6ICdJbnZhbGlkIGFyZ3VtZW50OiB0eXBlICh2YWxpZCBvcHRpb25zOiBbdm9pY2VdKScsXG4gICAgYXBwbGljYXRpb25BbnN3ZXJVcmw6ICdJbnZhbGlkIGFyZ3VtZW50OiBhbnN3ZXJVcmwnLFxuICAgIGFwcGxpY2F0aW9uRXZlbnRVcmw6ICdJbnZhbGlkIGFyZ3VtZW50OiBldmVudFVybCcsXG4gICAgYXBwbGljYXRpb25JZDogJ0ludmFsaWQgYXJndW1lbnQ6IGFwcElkJyxcbiAgICBwcm9kdWN0OiAnSW52YWxpZCBwcm9kdWN0LiBTaG91bGQgYmUgb25lIG9mIFt2b2ljZSwgc21zXSdcbn07XG5cbmV4cG9ydHMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKHBrZXksIHBzZWNyZXQsIG9wdGlvbnMpIHtcbiAgICBpZiAoIXBrZXkgfHwgIXBzZWNyZXQpIHtcbiAgICAgICAgdGhyb3cgJ2tleSBhbmQgc2VjcmV0IGNhbm5vdCBiZSBlbXB0eSwgc2V0IHZhbGlkIHZhbHVlcyc7XG4gICAgfVxuICAgIHVwID0ge1xuICAgICAgICBhcGlfa2V5OiBwa2V5LFxuICAgICAgICBhcGlfc2VjcmV0OiBwc2VjcmV0XG4gICAgfVxuICAgIF9vcHRpb25zID0gb3B0aW9ucztcbiAgICBpbml0aWFsaXplZCA9IHRydWU7XG59XG5cbmV4cG9ydHMuc2VuZEJpbmFyeU1lc3NhZ2UgPSBmdW5jdGlvbihzZW5kZXIsIHJlY2lwaWVudCwgYm9keSwgdWRoLCBjYWxsYmFjaykge1xuICAgIGlmICghYm9keSkge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5ib2R5KSk7XG4gICAgfSBlbHNlIGlmICghdWRoKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLnVkaCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHNlbmRNZXNzYWdlKHtcbiAgICAgICAgICAgIGZyb206IHNlbmRlcixcbiAgICAgICAgICAgIHRvOiByZWNpcGllbnQsXG4gICAgICAgICAgICB0eXBlOiAnYmluYXJ5JyxcbiAgICAgICAgICAgIGJvZHk6IGJvZHksXG4gICAgICAgICAgICB1ZGg6IHVkaFxuICAgICAgICB9LCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLnNlbmRXYXBQdXNoTWVzc2FnZSA9IGZ1bmN0aW9uKHNlbmRlciwgcmVjaXBpZW50LCB0aXRsZSwgdXJsLCB2YWxpZGl0eSwgY2FsbGJhY2spIHtcbiAgICBpZiAoIXRpdGxlKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLnRpdGxlKSk7XG4gICAgfSBlbHNlIGlmICghdXJsKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLnVybCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsaWRpdHkgPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FsbGJhY2sgPSB2YWxpZGl0eTtcbiAgICAgICAgICAgIHZhbGlkaXR5ID0gODY0MDAwMDA7XG4gICAgICAgIH1cbiAgICAgICAgc2VuZE1lc3NhZ2Uoe1xuICAgICAgICAgICAgZnJvbTogc2VuZGVyLFxuICAgICAgICAgICAgdG86IHJlY2lwaWVudCxcbiAgICAgICAgICAgIHR5cGU6ICd3YXBwdXNoJyxcbiAgICAgICAgICAgIHRpdGxlOiB0aXRsZSxcbiAgICAgICAgICAgIHZhbGlkaXR5OiB2YWxpZGl0eSxcbiAgICAgICAgICAgIHVybDogdXJsXG4gICAgICAgIH0sIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydHMuc2VuZFRleHRNZXNzYWdlID0gZnVuY3Rpb24oc2VuZGVyLCByZWNpcGllbnQsIG1lc3NhZ2UsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFtZXNzYWdlKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm1zZykpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghY2FsbGJhY2spIHtcblx0ICAgIFx0Y2FsbGJhY2sgPSBvcHRzO1xuICAgICAgICAgICAgb3B0cyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIG9wdHNbJ2Zyb20nXSA9IHNlbmRlcjtcbiAgICAgICAgb3B0c1sndG8nXSA9IHJlY2lwaWVudDtcbiAgICAgICAgb3B0c1sndGV4dCddID0gbWVzc2FnZTtcbiAgICAgICAgc2VuZE1lc3NhZ2Uob3B0cywgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy5zZW5kTWVzc2FnZSA9IGZ1bmN0aW9uKG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgICAgIHNlbmRNZXNzYWdlKG9wdHMsIGNhbGxiYWNrKTtcbn1cbmZ1bmN0aW9uIHNlbmRNZXNzYWdlKGRhdGEsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFkYXRhLmZyb20pIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuc2VuZGVyKSk7XG4gICAgfSBlbHNlIGlmICghZGF0YS50bykge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy50bykpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBwYXRoID0gY2xvbmUobXNncGF0aCk7XG5cdFx0cGF0aC5wYXRoKz0gJz8nICsgcXVlcnlzdHJpbmcuc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICBfb3B0aW9ucy5sb2dnZXIuaW5mbygnc2VuZGluZyBtZXNzYWdlIGZyb20gJyArIGRhdGEuZnJvbSArICcgdG8gJyArIGRhdGEudG8gKyAnIHdpdGggbWVzc2FnZSAnICsgZGF0YS50ZXh0KTtcbiAgICAgICAgc2VuZFJlcXVlc3QocGF0aCwgJ1BPU1QnLCBmdW5jdGlvbihlcnIsIGFwaVJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAoIWVyciAmJiBhcGlSZXNwb25zZS5zdGF0dXMgJiYgYXBpUmVzcG9uc2UubWVzc2FnZXNbMF0uc3RhdHVzID4gMCkge1xuICAgICAgICAgICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKGFwaVJlc3BvbnNlLm1lc3NhZ2VzWzBdWydlcnJvci10ZXh0J10pLCBhcGlSZXNwb25zZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soZXJyLCBhcGlSZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gc2VuZFZpYVNob3J0Y29kZSh0eXBlLCByZWNpcGllbnQsIG1lc3NhZ2VQYXJhbXMsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFyZWNpcGllbnQpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMudG8pKTtcbiAgICB9XG4gICAgaWYgKCFtZXNzYWdlUGFyYW1zIHx8ICFPYmplY3Qua2V5cyhtZXNzYWdlUGFyYW1zKSkge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5tc2dQYXJhbXMpKTtcbiAgICB9XG4gICAgb3B0cyA9IG9wdHMgfHwge307XG4gICAgdmFyIHBhdGggPSBjbG9uZShzaG9ydGNvZGVQYXRoKTtcbiAgICBwYXRoLnBhdGggPSBwYXRoLnBhdGgucmVwbGFjZSgnJHt0eXBlfScsIHR5cGUpO1xuICAgIE9iamVjdC5rZXlzKG1lc3NhZ2VQYXJhbXMpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG4gICAgICAgIG9wdHNba2V5XSA9IG1lc3NhZ2VQYXJhbXNba2V5XTtcbiAgICB9KTtcbiAgICBvcHRzLnRvID0gcmVjaXBpZW50O1xuICAgIHBhdGgucGF0aCs9ICc/JyArIHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeShvcHRzKTtcbiAgICBfb3B0aW9ucy5sb2dnZXIuaW5mbygnc2VuZGluZyBtZXNzYWdlIGZyb20gc2hvcnRjb2RlICcgKyB0eXBlICsgJyB0byAnICsgcmVjaXBpZW50ICsgJyB3aXRoIHBhcmFtZXRlcnMgJyArIEpTT04uc3RyaW5naWZ5KG1lc3NhZ2VQYXJhbXMpKTtcbiAgICBzZW5kUmVxdWVzdChwYXRoLCAnUE9TVCcsIGZ1bmN0aW9uKGVyciwgYXBpUmVzcG9uc2UpIHtcbiAgICAgICAgaWYgKCFlcnIgJiYgYXBpUmVzcG9uc2Uuc3RhdHVzICYmIGFwaVJlc3BvbnNlLm1lc3NhZ2VzWzBdLnN0YXR1cyA+IDApIHtcbiAgICAgICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKGFwaVJlc3BvbnNlLm1lc3NhZ2VzWzBdWydlcnJvci10ZXh0J10pLCBhcGlSZXNwb25zZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoY2FsbGJhY2spIGNhbGxiYWNrKGVyciwgYXBpUmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5leHBvcnRzLnNob3J0Y29kZUFsZXJ0ID0gZnVuY3Rpb24ocmVjaXBpZW50LCBtZXNzYWdlUGFyYW1zLCBvcHRzLCBjYWxsYmFjaykge1xuICAgIHNlbmRWaWFTaG9ydGNvZGUoJ2FsZXJ0JywgcmVjaXBpZW50LCBtZXNzYWdlUGFyYW1zLCBvcHRzLCBjYWxsYmFjayk7XG59XG5leHBvcnRzLnNob3J0Y29kZTJGQSA9IGZ1bmN0aW9uKHJlY2lwaWVudCwgbWVzc2FnZVBhcmFtcywgb3B0cywgY2FsbGJhY2spIHtcbiAgICBzZW5kVmlhU2hvcnRjb2RlKCcyZmEnLCByZWNpcGllbnQsIG1lc3NhZ2VQYXJhbXMsIG9wdHMsIGNhbGxiYWNrKTtcbn1cbmV4cG9ydHMuc2hvcnRjb2RlTWFya2V0aW5nID0gZnVuY3Rpb24ocmVjaXBpZW50LCBtZXNzYWdlUGFyYW1zLCBvcHRzLCBjYWxsYmFjaykge1xuICAgIHNlbmRWaWFTaG9ydGNvZGUoJ21hcmtldGluZycsIHJlY2lwaWVudCwgbWVzc2FnZVBhcmFtcywgb3B0cywgY2FsbGJhY2spO1xufVxuXG5mdW5jdGlvbiBjbG9uZShhKSB7XG4gICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhKSk7XG59XG5cbmZ1bmN0aW9uIGdldEVuZHBvaW50KGFjdGlvbikge1xuICAgIHJldHVybiB7cGF0aDphY3Rpb259O1xufVxuXG5mdW5jdGlvbiBzZW5kUmVxdWVzdChlbmRwb2ludCwgbWV0aG9kLCBjYWxsYmFjaykge1xuICBlbmRwb2ludC5wYXRoID0gZW5kcG9pbnQucGF0aCArXG4gICAgICAgICAgICAgICAgICAoZW5kcG9pbnQucGF0aC5pbmRleE9mKCc/Jyk+MD8nJic6Jz8nKSArIFxuICAgICAgICAgICAgICAgICAgcXVlcnlzdHJpbmcuc3RyaW5naWZ5KHVwKTtcbiAgX29wdGlvbnMuaHR0cENsaWVudC5yZXF1ZXN0KGVuZHBvaW50LCBtZXRob2QsIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0cy5jaGVja0JhbGFuY2UgPSBmdW5jdGlvbihjYWxsYmFjaykge1xuICAgIHZhciBiYWxhbmNlRW5kcG9pbnQgPSBnZXRFbmRwb2ludCgnL2FjY291bnQvZ2V0LWJhbGFuY2UnKTtcbiAgICBzZW5kUmVxdWVzdChiYWxhbmNlRW5kcG9pbnQsIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0cy5nZXRQcmljaW5nID0gZnVuY3Rpb24oY291bnRyeUNvZGUsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFjb3VudHJ5Q29kZSB8fCBjb3VudHJ5Q29kZS5sZW5ndGggIT0gMikge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5jb3VudHJ5Y29kZSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBwcmljaW5nRW5kcG9pbnQgPSBnZXRFbmRwb2ludCgnL2FjY291bnQvZ2V0LXByaWNpbmcvb3V0Ym91bmQnKTtcblx0XHRwcmljaW5nRW5kcG9pbnQucGF0aCArPSAnP2NvdW50cnk9JyArIGNvdW50cnlDb2RlO1xuICAgICAgICBzZW5kUmVxdWVzdChwcmljaW5nRW5kcG9pbnQsIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydHMuZ2V0UGhvbmVQcmljaW5nID0gZnVuY3Rpb24ocHJvZHVjdCwgbXNpc2RuLCBjYWxsYmFjaykge1xuICAgIGlmICghcHJvZHVjdCB8fCAocHJvZHVjdCAhPSAnc21zJyAmJiBwcm9kdWN0ICE9ICd2b2ljZScpKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLnByb2R1Y3QpKTtcbiAgICB9IGVsc2UgaWYgKCFtc2lzZG4gfHwgbXNpc2RuLmxlbmd0aCA8IDEwKSB7IC8vIGNoZWNrIGlmIE1TSVNETiB2YWxpZGF0aW9uIGlzIGNvcnJlY3QgZm9yIGludGVybmF0aW9uYWwgbnVtYmVyc1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5tc2lzZG4pKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcHJpY2luZ0VuZHBvaW50ID0gZ2V0RW5kcG9pbnQoJy9hY2NvdW50L2dldC1waG9uZS1wcmljaW5nL291dGJvdW5kJyk7XG5cdFx0ICAgIHByaWNpbmdFbmRwb2ludC5wYXRoICs9IFwiL1wiICsgcHJvZHVjdCArIFwiL1wiICsgdXAuYXBpX2tleSArIFwiL1wiICsgdXAuYXBpX3NlY3JldCArIFwiL1wiICsgbXNpc2RuO1xuICAgICAgICBzZW5kUmVxdWVzdChwcmljaW5nRW5kcG9pbnQsIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydHMuZ2V0TnVtYmVycyA9IGZ1bmN0aW9uKG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgdmFyIG51bWJlcnNFbmRwb2ludCA9IGdldEVuZHBvaW50KCcvYWNjb3VudC9udW1iZXJzJyk7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY2FsbGJhY2sgPSBvcHRpb25zO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIG9wdGlvbnMgPT0gJ29iamVjdCcpe1xuICAgICAgICBudW1iZXJzRW5kcG9pbnQucGF0aCA9IG51bWJlcnNFbmRwb2ludC5wYXRoICsgJz8nO1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gb3B0aW9ucyl7XG4gICAgICAgICAgICBudW1iZXJzRW5kcG9pbnQucGF0aCA9IG51bWJlcnNFbmRwb2ludC5wYXRoICsga2V5ICsgJz0nICsgb3B0aW9uc1trZXldICsgJyYnXG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5vcHRpb25zTm90QW5PYmplY3QpKTtcblx0XHRyZXR1cm47XG4gICAgfVxuXHRzZW5kUmVxdWVzdChudW1iZXJzRW5kcG9pbnQsIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0cy5zZWFyY2hOdW1iZXJzID0gZnVuY3Rpb24oY291bnRyeUNvZGUsIHBhdHRlcm4sIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFjb3VudHJ5Q29kZSB8fCBjb3VudHJ5Q29kZS5sZW5ndGggIT0gMikge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5jb3VudHJ5Y29kZSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBzZWFyY2hFbmRwb2ludCA9IGdldEVuZHBvaW50KCcvbnVtYmVyL3NlYXJjaCcpIDtcblx0XHRzZWFyY2hFbmRwb2ludC5wYXRoICs9ICc/Y291bnRyeT0nICsgY291bnRyeUNvZGVcbiAgICAgICAgaWYgKHR5cGVvZiBwYXR0ZXJuID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrID0gcGF0dGVybjtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcGF0dGVybiA9PSAnb2JqZWN0Jyl7XG4gICAgICAgICAgICBzZWFyY2hFbmRwb2ludC5wYXRoID0gc2VhcmNoRW5kcG9pbnQucGF0aCArICcmJztcbiAgICAgICAgICAgIGZvciAodmFyIGFyZyBpbiBwYXR0ZXJuKXtcbiAgICAgICAgICAgICAgICBzZWFyY2hFbmRwb2ludC5wYXRoID0gc2VhcmNoRW5kcG9pbnQucGF0aCArIGFyZyArICc9JyArIHBhdHRlcm5bYXJnXSArICcmJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2VhcmNoRW5kcG9pbnQucGF0aCA9IHNlYXJjaEVuZHBvaW50LnBhdGggKyAnJnBhdHRlcm49JyArIHBhdHRlcm47XG4gICAgICAgIH1cbiAgICAgICAgc2VuZFJlcXVlc3Qoc2VhcmNoRW5kcG9pbnQsIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydHMuYnV5TnVtYmVyID0gZnVuY3Rpb24oY291bnRyeUNvZGUsIG1zaXNkbiwgY2FsbGJhY2spIHtcbiAgICBpZiAoIWNvdW50cnlDb2RlIHx8IGNvdW50cnlDb2RlLmxlbmd0aCAhPSAyKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmNvdW50cnljb2RlKSk7XG4gICAgfSBlbHNlIGlmICghbXNpc2RuIHx8IG1zaXNkbi5sZW5ndGggPCAxMCkgeyAvLyBjaGVjayBpZiBNU0lTRE4gdmFsaWRhdGlvbiBpcyBjb3JyZWN0IGZvciBpbnRlcm5hdGlvbmFsIG51bWJlcnNcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMubXNpc2RuKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGJ1eUVuZHBvaW50ID0gZ2V0RW5kcG9pbnQoJy9udW1iZXIvYnV5Jyk7XG5cdFx0YnV5RW5kcG9pbnQucGF0aCArPSAnP2NvdW50cnk9JyArIGNvdW50cnlDb2RlICsgJyZtc2lzZG49JyArIG1zaXNkbjtcbiAgICAgICAgc2VuZFJlcXVlc3QoYnV5RW5kcG9pbnQsICdQT1NUJywgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy5jYW5jZWxOdW1iZXIgPSBmdW5jdGlvbihjb3VudHJ5Q29kZSwgbXNpc2RuLCBjYWxsYmFjaykge1xuICAgIGlmICghY291bnRyeUNvZGUgfHwgY291bnRyeUNvZGUubGVuZ3RoICE9IDIpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuY291bnRyeWNvZGUpKTtcbiAgICB9IGVsc2UgaWYgKCFtc2lzZG4gfHwgbXNpc2RuLmxlbmd0aCA8IDEwKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm1zaXNkbikpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBjYW5jZWxFbmRwb2ludCA9IGdldEVuZHBvaW50KCcvbnVtYmVyL2NhbmNlbCcpO1xuXHRcdGNhbmNlbEVuZHBvaW50LnBhdGggKz0gJz9jb3VudHJ5PScgKyBjb3VudHJ5Q29kZSArICcmbXNpc2RuPScgKyBtc2lzZG47XG4gICAgICAgIHNlbmRSZXF1ZXN0KGNhbmNlbEVuZHBvaW50LCAnUE9TVCcsIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydHMuY2FuY2VsTnVtYmVyID0gZnVuY3Rpb24oY291bnRyeUNvZGUsIG1zaXNkbiwgY2FsbGJhY2spIHtcbiAgICBpZiAoIWNvdW50cnlDb2RlIHx8IGNvdW50cnlDb2RlLmxlbmd0aCAhPSAyKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmNvdW50cnljb2RlKSk7XG4gICAgfSBlbHNlIGlmICghbXNpc2RuIHx8IG1zaXNkbi5sZW5ndGggPCAxMCkge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5tc2lzZG4pKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgY2FuY2VsRW5kcG9pbnQgPSBnZXRFbmRwb2ludCgnL251bWJlci9jYW5jZWwnKTtcblx0XHRjYW5jZWxFbmRwb2ludC5wYXRoICs9ICc/Y291bnRyeT0nICsgY291bnRyeUNvZGUgKyAnJm1zaXNkbj0nICsgbXNpc2RuO1xuICAgICAgICBzZW5kUmVxdWVzdChjYW5jZWxFbmRwb2ludCwgJ1BPU1QnLCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLnVwZGF0ZU51bWJlciA9IGZ1bmN0aW9uKGNvdW50cnlDb2RlLCBtc2lzZG4sIHBhcmFtcywgY2FsbGJhY2spe1xuICAgIGlmICghY291bnRyeUNvZGUgfHwgY291bnRyeUNvZGUubGVuZ3RoICE9IDIpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuY291bnRyeWNvZGUpKTtcbiAgICB9IGVsc2UgaWYgKCFtc2lzZG4gfHwgbXNpc2RuLmxlbmd0aCA8IDEwKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm1zaXNkbikpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciB1cGRhdGVFbmRwb2ludCA9IGdldEVuZHBvaW50KCcvbnVtYmVyL3VwZGF0ZScpO1xuXHR1cGRhdGVFbmRwb2ludC5wYXRoICs9ICc/Y291bnRyeT0nICsgY291bnRyeUNvZGUgKyAnJm1zaXNkbj0nICsgbXNpc2RuO1xuICAgICAgICB1cGRhdGVFbmRwb2ludC5wYXRoID0gdXBkYXRlRW5kcG9pbnQucGF0aCArICcmJztcbiAgICAgICAgZm9yICh2YXIgYXJnIGluIHBhcmFtcyl7XG4gICAgICAgICAgICB1cGRhdGVFbmRwb2ludC5wYXRoID0gdXBkYXRlRW5kcG9pbnQucGF0aCArIGFyZyArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudChwYXJhbXNbYXJnXSkgKyAnJidcbiAgICAgICAgfVxuICAgICAgICBzZW5kUmVxdWVzdCh1cGRhdGVFbmRwb2ludCwgJ1BPU1QnLCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLmdldEFwcGxpY2F0aW9ucyA9IGZ1bmN0aW9uKG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gICAgdmFyIGVuZHBvaW50ID0gZ2V0RW5kcG9pbnQoYXBwbGljYXRpb25zRW5kcG9pbnQucGF0aCk7XG4gICAgZW5kcG9pbnQuaG9zdCA9IGFwcGxpY2F0aW9uc0VuZHBvaW50Lmhvc3Q7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgY2FsbGJhY2sgPSBvcHRpb25zO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIG9wdGlvbnMgPT0gJ29iamVjdCcpe1xuICAgICAgICBlbmRwb2ludC5wYXRoICs9ICc/JztcbiAgICAgICAgZm9yICh2YXIga2V5IGluIG9wdGlvbnMpe1xuICAgICAgICAgICAgZW5kcG9pbnQucGF0aCArPSAoa2V5ICsgJz0nICsgb3B0aW9uc1trZXldICsgJyYnKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm9wdGlvbnNOb3RBbk9iamVjdCkpO1xuICBcdCAgICByZXR1cm47XG4gICAgfVxuICBzZW5kUmVxdWVzdChlbmRwb2ludCwgY2FsbGJhY2spO1xufVxuXG5leHBvcnRzLmNyZWF0ZUFwcGxpY2F0aW9uID0gZnVuY3Rpb24obmFtZSwgdHlwZSwgYW5zd2VyVXJsLCBldmVudFVybCwgb3B0aW9ucywgY2FsbGJhY2spIHtcbiAgaWYgKCFuYW1lIHx8IG5hbWUubGVuZ3RoIDwgMSkge1xuICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYXBwbGljYXRpb25OYW1lKSk7XG4gIH0gZWxzZSBpZiAoIXR5cGUgfHwgdHlwZSAhPSAndm9pY2UnKSB7XG4gICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5hcHBsaWNhdGlvblR5cGUpKTtcbiAgfSBlbHNlIGlmICghYW5zd2VyVXJsKSB7XG4gICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5hcHBsaWNhdGlvbkFuc3dlclVybCkpO1xuICB9IGVsc2UgaWYgKCFldmVudFVybCkge1xuICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYXBwbGljYXRpb25FdmVudFVybCkpO1xuICB9IGVsc2Uge1xuICAgICAgdmFyIGNyZWF0ZUVuZHBvaW50ID0gZ2V0RW5kcG9pbnQoYXBwbGljYXRpb25zRW5kcG9pbnQucGF0aCk7XG4gICAgICBjcmVhdGVFbmRwb2ludC5ob3N0ID0gYXBwbGljYXRpb25zRW5kcG9pbnQuaG9zdDtcbiAgICAgIGNyZWF0ZUVuZHBvaW50LnBhdGggKz0gKCc/bmFtZT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJyZ0eXBlPScgKyB0eXBlICArICcmYW5zd2VyX3VybD0nICsgYW5zd2VyVXJsICArICcmZXZlbnRfdXJsPScgKyBldmVudFVybCk7XG4gICAgICBmb3IgKHZhciBrZXkgaW4gb3B0aW9ucyl7XG4gICAgICAgICAgY3JlYXRlRW5kcG9pbnQucGF0aCArPSAoJyYnICsga2V5ICsgJz0nICsgb3B0aW9uc1trZXldKTtcbiAgICAgIH1cbiAgICAgIHNlbmRSZXF1ZXN0KGNyZWF0ZUVuZHBvaW50LCAnUE9TVCcsIGNhbGxiYWNrKTtcbiAgfVxufVxuXG5leHBvcnRzLmdldEFwcGxpY2F0aW9uID0gZnVuY3Rpb24oYXBwSWQsIGNhbGxiYWNrKSB7XG4gIGlmICghYXBwSWQgfHwgYXBwSWQubGVuZ3RoIDwgMzYpIHtcbiAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmFwcGxpY2F0aW9uSWQpKTtcbiAgfSBlbHNlIHtcbiAgICAgIHZhciBzaG93RW5kcG9pbnQgPSBnZXRFbmRwb2ludChhcHBsaWNhdGlvbnNFbmRwb2ludC5wYXRoICsgXCIvXCIgKyBhcHBJZCk7XG4gICAgICBzaG93RW5kcG9pbnQuaG9zdCA9IGFwcGxpY2F0aW9uc0VuZHBvaW50Lmhvc3Q7XG4gICAgICBzZW5kUmVxdWVzdChzaG93RW5kcG9pbnQsIGNhbGxiYWNrKTtcbiAgfVxufVxuXG5leHBvcnRzLnVwZGF0ZUFwcGxpY2F0aW9uID0gZnVuY3Rpb24oYXBwSWQsIG5hbWUsIHR5cGUsIGFuc3dlclVybCwgZXZlbnRVcmwsIG9wdGlvbnMsIGNhbGxiYWNrKSB7XG4gIGlmICghYXBwSWQgfHwgYXBwSWQubGVuZ3RoIDwgMzYpIHtcbiAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmFwcGxpY2F0aW9uSWQpKTtcbiAgfSBlbHNlIGlmICghbmFtZSB8fCBuYW1lLmxlbmd0aCA8IDEpIHtcbiAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmFwcGxpY2F0aW9uTmFtZSkpO1xuICB9IGVsc2UgaWYgKCF0eXBlIHx8IHR5cGUgIT0gJ3ZvaWNlJykge1xuICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYXBwbGljYXRpb25UeXBlKSk7XG4gIH0gZWxzZSBpZiAoIWFuc3dlclVybCkge1xuICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYXBwbGljYXRpb25BbnN3ZXJVcmwpKTtcbiAgfSBlbHNlIGlmICghZXZlbnRVcmwpIHtcbiAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmFwcGxpY2F0aW9uRXZlbnRVcmwpKTtcbiAgfSBlbHNlIHtcbiAgICAgIHZhciB1cGRhdGVFbmRwb2ludCA9IGdldEVuZHBvaW50KGFwcGxpY2F0aW9uc0VuZHBvaW50LnBhdGggKyBcIi9cIiArIGFwcElkKTtcbiAgICAgIHVwZGF0ZUVuZHBvaW50LnBhdGggKz0gKCc/bmFtZT0nICsgZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICsgJyZ0eXBlPScgKyB0eXBlICArICcmYW5zd2VyX3VybD0nICsgYW5zd2VyVXJsICArICcmZXZlbnRfdXJsPScgKyBldmVudFVybCk7XG4gICAgICB1cGRhdGVFbmRwb2ludC5ob3N0ID0gYXBwbGljYXRpb25zRW5kcG9pbnQuaG9zdDtcbiAgICAgIGZvciAodmFyIGtleSBpbiBvcHRpb25zKXtcbiAgICAgICAgICB1cGRhdGVFbmRwb2ludC5wYXRoID0gdXBkYXRlRW5kcG9pbnQucGF0aCArICcmJyArIGtleSArICc9JyArIG9wdGlvbnNba2V5XTtcbiAgICAgIH1cbiAgICAgIHNlbmRSZXF1ZXN0KHVwZGF0ZUVuZHBvaW50LCAnUFVUJywgY2FsbGJhY2spO1xuICB9XG59XG5cbmV4cG9ydHMuZGVsZXRlQXBwbGljYXRpb24gPSBmdW5jdGlvbihhcHBJZCwgY2FsbGJhY2spIHtcbiAgaWYgKCFhcHBJZCB8fCBhcHBJZC5sZW5ndGggPCAzNikge1xuICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYXBwbGljYXRpb25JZCkpO1xuICB9IGVsc2Uge1xuICAgICAgdmFyIGRlbGV0ZUVuZHBvaW50ID0gZ2V0RW5kcG9pbnQoYXBwbGljYXRpb25zRW5kcG9pbnQucGF0aCArIFwiL1wiICsgYXBwSWQpO1xuICAgICAgZGVsZXRlRW5kcG9pbnQuaG9zdCA9IGFwcGxpY2F0aW9uc0VuZHBvaW50Lmhvc3Q7XG4gICAgICBzZW5kUmVxdWVzdChkZWxldGVFbmRwb2ludCwgJ0RFTEVURScsIGNhbGxiYWNrKTtcbiAgfVxufVxuXG5cbmV4cG9ydHMuY2hhbmdlUGFzc3dvcmQgPSBmdW5jdGlvbihuZXdTZWNyZXQsIGNhbGxiYWNrKSB7XG4gICAgdmFyIHNldHRpbmdzRW5kcG9pbnQgPSBnZXRFbmRwb2ludCgnL2FjY291bnQvc2V0dGluZ3MnKTtcblx0c2V0dGluZ3NFbmRwb2ludC5wYXRoICs9ICc/bmV3U2VjcmV0PScgKyBlbmNvZGVVUklDb21wb25lbnQobmV3U2VjcmV0KTtcbiAgICBzZW5kUmVxdWVzdChzZXR0aW5nc0VuZHBvaW50LCAnUE9TVCcsIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0cy5jaGFuZ2VNb0NhbGxiYWNrVXJsID0gZnVuY3Rpb24obmV3VXJsLCBjYWxsYmFjaykge1xuICAgIHZhciBzZXR0aW5nc0VuZHBvaW50ID0gZ2V0RW5kcG9pbnQoJy9hY2NvdW50L3NldHRpbmdzJyk7XG5cdHNldHRpbmdzRW5kcG9pbnQucGF0aCAgKz0gJz9tb0NhbGxCYWNrVXJsPScgKyBlbmNvZGVVUklDb21wb25lbnQobmV3VXJsKTtcbiAgICBzZW5kUmVxdWVzdChzZXR0aW5nc0VuZHBvaW50LCAnUE9TVCcsIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0cy5jaGFuZ2VEckNhbGxiYWNrVXJsID0gZnVuY3Rpb24obmV3VXJsLCBjYWxsYmFjaykge1xuICAgIHZhciBzZXR0aW5nc0VuZHBvaW50ID0gZ2V0RW5kcG9pbnQoJy9hY2NvdW50L3NldHRpbmdzJyk7XG5cdHNldHRpbmdzRW5kcG9pbnQucGF0aCAgKz0gJz9kckNhbGxCYWNrVXJsPScgKyBlbmNvZGVVUklDb21wb25lbnQobmV3VXJsKTtcbiAgICBzZW5kUmVxdWVzdChzZXR0aW5nc0VuZHBvaW50LCAnUE9TVCcsIGNhbGxiYWNrKTtcbn1cblxuZXhwb3J0cy52ZXJpZnlOdW1iZXIgPSBmdW5jdGlvbihpbnB1dFBhcmFtcywgY2FsbGJhY2spIHtcblx0aWYgKCFpbnB1dFBhcmFtcy5udW1iZXIgfHwgIWlucHV0UGFyYW1zLmJyYW5kICkge1xuXHRcdHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLnZlcmlmeVZhbGlkYXRpb24pKTtcbiAgICB9IGVsc2Uge1xuXHRcdHZhciB2RW5kcG9pbnQgPSBjbG9uZSh2ZXJpZnlFbmRwb2ludCk7XG5cdFx0dkVuZHBvaW50LnBhdGggKz0gJz8nICsgcXVlcnlzdHJpbmcuc3RyaW5naWZ5KGlucHV0UGFyYW1zKTtcbiAgICAgICAgc2VuZFJlcXVlc3QodkVuZHBvaW50LCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLmNoZWNrVmVyaWZ5UmVxdWVzdCA9IGZ1bmN0aW9uKGlucHV0UGFyYW1zLCBjYWxsYmFjaykge1xuXHRpZiAoIWlucHV0UGFyYW1zLnJlcXVlc3RfaWQgfHwgIWlucHV0UGFyYW1zLmNvZGUgKSB7XG5cdFx0c2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuY2hlY2tWZXJpZnlWYWxpZGF0aW9uKSk7XG4gICAgfSBlbHNlIHtcblx0XHR2YXIgdkVuZHBvaW50ID0gY2xvbmUoY2hlY2tWZXJpZnlFbmRwb2ludCk7XG5cdFx0dkVuZHBvaW50LnBhdGggKz0gJz8nICsgcXVlcnlzdHJpbmcuc3RyaW5naWZ5KGlucHV0UGFyYW1zKTtcbiAgICAgICAgc2VuZFJlcXVlc3QodkVuZHBvaW50LCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLmNvbnRyb2xWZXJpZnlSZXF1ZXN0ID0gZnVuY3Rpb24oaW5wdXRQYXJhbXMsIGNhbGxiYWNrKSB7XG5cdGlmICghaW5wdXRQYXJhbXMucmVxdWVzdF9pZCB8fCAhaW5wdXRQYXJhbXMuY21kICkge1xuXHRcdHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLmNvbnRyb2xWZXJpZnlWYWxpZGF0aW9uKSk7XG4gICAgfSBlbHNlIHtcblx0XHR2YXIgdkVuZHBvaW50ID0gY2xvbmUoY29udHJvbFZlcmlmeUVuZHBvaW50KTtcblx0XHR2RW5kcG9pbnQucGF0aCArPSAnPycgKyBxdWVyeXN0cmluZy5zdHJpbmdpZnkoaW5wdXRQYXJhbXMpO1xuICAgICAgICBzZW5kUmVxdWVzdCh2RW5kcG9pbnQsIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydHMuc2VhcmNoVmVyaWZ5UmVxdWVzdCA9IGZ1bmN0aW9uKHJlcXVlc3RJZHMsIGNhbGxiYWNrKSB7XG5cdHZhciByZXF1ZXN0SWRQYXJhbSA9IHt9O1xuXHRpZiAoIXJlcXVlc3RJZHMpIHtcblx0XHRzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5zZWFyY2hWZXJpZnlWYWxpZGF0aW9uKSk7XG4gICAgfSBlbHNlIHtcblx0XHRpZiAoQXJyYXkuaXNBcnJheShyZXF1ZXN0SWRzKSApIHtcblx0XHRcdGlmIChyZXF1ZXN0SWRzLmxlbmd0aCA9PTEpIHtcblx0XHRcdFx0cmVxdWVzdElkUGFyYW0ucmVxdWVzdF9pZD1yZXF1ZXN0SWRzO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVxdWVzdElkUGFyYW0ucmVxdWVzdF9pZHM9cmVxdWVzdElkcztcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0cmVxdWVzdElkUGFyYW0ucmVxdWVzdF9pZD1yZXF1ZXN0SWRzO1xuXHRcdH1cblx0XHR2YXIgdkVuZHBvaW50ID0gY2xvbmUoc2VhcmNoVmVyaWZ5RW5kcG9pbnQpO1xuXHRcdHZFbmRwb2ludC5wYXRoICs9ICc/JyArIHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeShyZXF1ZXN0SWRQYXJhbSk7XG4gICAgICAgIHNlbmRSZXF1ZXN0KHZFbmRwb2ludCwgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy5udW1iZXJJbnNpZ2h0ID0gZnVuY3Rpb24oaW5wdXRQYXJhbXMsIGNhbGxiYWNrKSB7XG5cdGlmICghaW5wdXRQYXJhbXMubnVtYmVyIHx8ICEgaW5wdXRQYXJhbXMuY2FsbGJhY2spIHtcblx0XHRzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5udW1iZXJJbnNpZ2h0QWR2YW5jZWRWYWxpZGF0aW9uKSk7XG4gICAgfSBlbHNlIHtcblx0XHR2YXIgbkVuZHBvaW50ID0gY2xvbmUobmlFbmRwb2ludCk7XG5cdFx0bkVuZHBvaW50LnBhdGggKz0gJz8nICsgcXVlcnlzdHJpbmcuc3RyaW5naWZ5KGlucHV0UGFyYW1zKTtcbiAgICAgICAgc2VuZFJlcXVlc3QobkVuZHBvaW50LCBjYWxsYmFjayk7XG4gICAgfVxufVxuXG5leHBvcnRzLm51bWJlckluc2lnaHRCYXNpYyA9IGZ1bmN0aW9uKGlucHV0UGFyYW1zLCBjYWxsYmFjaykge1xuXHRudW1iZXJJbnNpZ2h0Q29tbW9uKG5pQmFzaWNFbmRwb2ludCxpbnB1dFBhcmFtcyxjYWxsYmFjaylcbn1cblxuZXhwb3J0cy5udW1iZXJJbnNpZ2h0U3RhbmRhcmQgPSBmdW5jdGlvbihpbnB1dFBhcmFtcywgY2FsbGJhY2spIHtcblx0bnVtYmVySW5zaWdodENvbW1vbihuaVN0YW5kYXJkRW5kcG9pbnQsaW5wdXRQYXJhbXMsY2FsbGJhY2spXG59XG5cbmZ1bmN0aW9uIG51bWJlckluc2lnaHRDb21tb24oZW5kcG9pbnQsaW5wdXRQYXJhbXMsY2FsbGJhY2spIHtcblx0aWYgKHZhbGlkYXRlTnVtYmVyKGlucHV0UGFyYW1zLGNhbGxiYWNrKSl7XG5cdFx0dmFyIGlucHV0T2JqO1xuXHRcdGlmICh0eXBlb2YgaW5wdXRQYXJhbXMgIT0gJ29iamVjdCcpIHtcblx0XHRcdGlucHV0T2JqID0ge251bWJlcjppbnB1dFBhcmFtc307XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlucHV0T2JqID0gaW5wdXRQYXJhbXM7XG5cdFx0fVxuXHRcdHZhciBuRW5kcG9pbnQgPSBjbG9uZShlbmRwb2ludCk7XG5cdFx0bkVuZHBvaW50LnBhdGggKz0gJz8nICsgcXVlcnlzdHJpbmcuc3RyaW5naWZ5KGlucHV0T2JqKTtcblx0ICAgIHNlbmRSZXF1ZXN0KG5FbmRwb2ludCwgY2FsbGJhY2spO1xuXHR9XG59XG5mdW5jdGlvbiB2YWxpZGF0ZU51bWJlcihpbnB1dFBhcmFtcyxjYWxsYmFjaykge1xuXHRpZiAoKHR5cGVvZiBpbnB1dFBhcmFtcyA9PSAnb2JqZWN0JykgJiYgIWlucHV0UGFyYW1zLm51bWJlcikge1xuXHRcdFx0c2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMubnVtYmVySW5zaWdodFZhbGlkYXRpb24pKTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0fSBlbHNlIGlmICgodHlwZW9mIGlucHV0UGFyYW1zID09ICdvYmplY3QnKSAmJiAhbnVtYmVyUGF0dGVybi50ZXN0KGlucHV0UGFyYW1zLm51bWJlcikpIHtcblx0XHRcdHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm51bWJlckluc2lnaHRQYXR0ZXJuRmFpbHVyZSkpO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuICAgIH0gZWxzZSBpZiAoKHR5cGVvZiBpbnB1dFBhcmFtcyAhPSAnb2JqZWN0JykgJiYgKCFpbnB1dFBhcmFtcyB8fCAhbnVtYmVyUGF0dGVybi50ZXN0KGlucHV0UGFyYW1zKSkpe1xuXHRcdHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm51bWJlckluc2lnaHRQYXR0ZXJuRmFpbHVyZSkpO1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXHRyZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gc2VuZFZvaWNlTWVzc2FnZSh2b2ljZUVuZHBvaW50LCBkYXRhLCBjYWxsYmFjaykge1xuICAgIGlmICghZGF0YS50bykge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy50bykpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciBlbmRwb2ludCA9IGNsb25lKHZvaWNlRW5kcG9pbnQpO1xuXHRcdGVuZHBvaW50LnBhdGggKz0gJz8nICsgcXVlcnlzdHJpbmcuc3RyaW5naWZ5KGRhdGEpO1xuICAgICAgICBfb3B0aW9ucy5sb2dnZXIuaW5mbygnc2VuZGluZyBUVFMgbWVzc2FnZSB0byAnICsgZGF0YS50byArICcgd2l0aCBtZXNzYWdlICcgKyBkYXRhLnRleHQpO1xuICAgICAgICBzZW5kUmVxdWVzdChlbmRwb2ludCwgJ1BPU1QnLCBmdW5jdGlvbihlcnIsIGFwaVJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZiAoIWVyciAmJiBhcGlSZXNwb25zZS5zdGF0dXMgJiYgYXBpUmVzcG9uc2Uuc3RhdHVzID4gMCkge1xuICAgICAgICAgICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKGFwaVJlc3BvbnNlWydlcnJvci10ZXh0J10pLCBhcGlSZXNwb25zZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2soZXJyLCBhcGlSZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuZXhwb3J0cy5zZW5kVFRTTWVzc2FnZSA9IGZ1bmN0aW9uKHJlY2lwaWVudCwgbWVzc2FnZSwgb3B0cywgY2FsbGJhY2spIHtcbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMubXNnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFvcHRzKSB7XG4gICAgICAgICAgICBvcHRzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgb3B0c1sndG8nXSA9IHJlY2lwaWVudDtcbiAgICAgICAgb3B0c1sndGV4dCddID0gbWVzc2FnZTtcbiAgICAgICAgc2VuZFZvaWNlTWVzc2FnZSh0dHNFbmRwb2ludCwgb3B0cywgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy5zZW5kVFRTUHJvbXB0V2l0aENhcHR1cmUgPSBmdW5jdGlvbihyZWNpcGllbnQsIG1lc3NhZ2UsIG1heERpZ2l0cywgYnllVGV4dCwgb3B0cywgY2FsbGJhY2spIHtcbiAgICBpZiAoIW1lc3NhZ2UpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMubXNnKSk7XG4gICAgfSBlbHNlIGlmICghbWF4RGlnaXRzIHx8IGlzTmFOKG1heERpZ2l0cykgfHwgbWF4RGlnaXRzLmxlbmd0aCA+IDE2KSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm1heERpZ2l0cykpO1xuICAgIH0gZWxzZSBpZiAoIWJ5ZVRleHQpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYnllVGV4dCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghb3B0cykge1xuICAgICAgICAgICAgb3B0cyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIG9wdHNbJ3RvJ10gPSByZWNpcGllbnQ7XG4gICAgICAgIG9wdHNbJ3RleHQnXSA9IG1lc3NhZ2U7XG4gICAgICAgIG9wdHNbJ21heF9kaWdpdHMnXSA9IG1heERpZ2l0cztcbiAgICAgICAgb3B0c1snYnllX3RleHQnXSA9IGJ5ZVRleHQ7XG4gICAgICAgIHNlbmRWb2ljZU1lc3NhZ2UodHRzUHJvbXB0RW5kcG9pbnQsIG9wdHMsIGNhbGxiYWNrKTtcbiAgICB9XG59XG5cbmV4cG9ydHMuc2VuZFRUU1Byb21wdFdpdGhDb25maXJtID0gZnVuY3Rpb24ocmVjaXBpZW50LCBtZXNzYWdlLCBtYXhEaWdpdHMsIHBpbkNvZGUsIGJ5ZVRleHQsIGZhaWxlZFRleHQsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFtZXNzYWdlKSB7XG4gICAgICAgIHNlbmRFcnJvcihjYWxsYmFjaywgbmV3IEVycm9yKEVSUk9SX01FU1NBR0VTLm1zZykpO1xuICAgIH0gZWxzZSBpZiAoIW1heERpZ2l0cyB8fCBpc05hTihtYXhEaWdpdHMpIHx8IG1heERpZ2l0cy5sZW5ndGggPiAxNikge1xuICAgICAgICBzZW5kRXJyb3IoY2FsbGJhY2ssIG5ldyBFcnJvcihFUlJPUl9NRVNTQUdFUy5tYXhEaWdpdHMpKTtcbiAgICB9IGVsc2UgaWYgKCFwaW5Db2RlIHx8IHBpbkNvZGUubGVuZ3RoICE9PSBtYXhEaWdpdHMpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMucGluQ29kZSkpO1xuICAgIH0gZWxzZSBpZiAoIWJ5ZVRleHQpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYnllVGV4dCkpO1xuICAgIH0gZWxzZSBpZiAoIWZhaWxlZFRleHQpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuZmFpbGVkVGV4dCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghb3B0cykge1xuICAgICAgICAgICAgb3B0cyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIG9wdHNbJ3RvJ10gPSByZWNpcGllbnQ7XG4gICAgICAgIG9wdHNbJ3RleHQnXSA9IG1lc3NhZ2U7XG4gICAgICAgIG9wdHNbJ21heF9kaWdpdHMnXSA9IG1heERpZ2l0cztcbiAgICAgICAgb3B0c1sncGluX2NvZGUnXSA9IHBpbkNvZGU7XG4gICAgICAgIG9wdHNbJ2J5ZV90ZXh0J10gPSBieWVUZXh0O1xuICAgICAgICBvcHRzWydmYWlsZWRfdGV4dCddID0gZmFpbGVkVGV4dDtcbiAgICAgICAgc2VuZFZvaWNlTWVzc2FnZSh0dHNQcm9tcHRFbmRwb2ludCwgb3B0cywgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZXhwb3J0cy5jYWxsID0gZnVuY3Rpb24ocmVjaXBpZW50LCBhbnN3ZXJVcmwsIG9wdHMsIGNhbGxiYWNrKSB7XG4gICAgaWYgKCFhbnN3ZXJVcmwpIHtcbiAgICAgICAgc2VuZEVycm9yKGNhbGxiYWNrLCBuZXcgRXJyb3IoRVJST1JfTUVTU0FHRVMuYW5zd2VyVXJsKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCFvcHRzKSB7XG4gICAgICAgICAgICBvcHRzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgb3B0c1sndG8nXSA9IHJlY2lwaWVudDtcbiAgICAgICAgb3B0c1snYW5zd2VyX3VybCddID0gYW5zd2VyVXJsO1xuICAgICAgICBzZW5kVm9pY2VNZXNzYWdlKGNhbGxFbmRwb2ludCwgb3B0cywgY2FsbGJhY2spO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gc2VuZEVycm9yKGNhbGxiYWNrLCBlcnIsIHJldHVybkRhdGEpIHtcbiAgICAvLyBUaHJvdyB0aGUgZXJyb3IgaW4gY2FzZSBpZiB0aGVyZSBpcyBubyBjYWxsYmFjayBwYXNzZWRcbiAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2soZXJyLCByZXR1cm5EYXRhKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgfVxufVxuXG5leHBvcnRzLnNldEhvc3QgPSBmdW5jdGlvbihhSG9zdCkge1xuICAgIG1zZ3BhdGguaG9zdCA9IGFIb3N0O1xuICAgIHNob3J0Y29kZVBhdGguaG9zdCA9IGFIb3N0O1xuICAgIHR0c0VuZHBvaW50Lmhvc3QgPSBhSG9zdDtcbiAgICB0dHNQcm9tcHRFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gICAgY2FsbEVuZHBvaW50Lmhvc3QgPSBhSG9zdDtcbiAgICB2ZXJpZnlFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gICAgY2hlY2tWZXJpZnlFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gICAgY29udHJvbFZlcmlmeUVuZHBvaW50Lmhvc3QgPSBhSG9zdDtcbiAgICBzZWFyY2hWZXJpZnlFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gICAgbmlFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG5cdG5pQmFzaWNFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG5cdG5pU3RhbmRhcmRFbmRwb2ludC5ob3N0ID0gYUhvc3Q7XG4gIGFwcGxpY2F0aW9uc0VuZHBvaW50Lmhvc3QgPSBhSG9zdDtcbn1cblxuZXhwb3J0cy5zZXRQb3J0ID0gZnVuY3Rpb24oYVBvcnQpIHtcbiAgcG9ydCA9IGFQb3J0O1xufVxuIl19